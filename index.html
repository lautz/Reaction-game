<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reaction Lab | Reflex Engine</title>
    
    <!-- Typography: Inter for UI, JetBrains Mono for Data -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- Three.js Core -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="app-container">
        
        <!-- 3D Background Canvas -->
        <div id="canvas-container"></div>

        <!-- Quit Button (Hidden on setup, visible in game/summary) -->
        <button id="btn-quit" class="hidden">QUIT</button>

        <!-- Setup Phase -->
        <section id="setup-screen" class="glass-panel active">
            <header>
                <h1>REACTION LAB</h1>
                <p class="subtitle">NEURAL LATENCY TRAINER</p>
            </header>
            
            <div class="instructions">
                <strong>PROTOCOL:</strong><br>
                1. Engage <span class="highlight-trigger">GREEN</span> signal immediately.<br>
                2. IGNORE all hostile signals (Decoys).<br>
                3. Maintain focus. System will scale complexity.
            </div>

            <div class="controls-grid">
                <div class="control-group">
                    <label>START INTENSITY <span id="start-val" class="mono">1</span></label>
                    <input type="range" id="start-diff" min="1" max="10" value="1" step="1">
                    <div class="meta-label">Initial Velocity & Focus</div>
                </div>

                <div class="control-group">
                    <label>TARGET INTENSITY <span id="end-val" class="mono">10</span></label>
                    <input type="range" id="end-diff" min="1" max="10" value="10" step="1">
                    <div class="meta-label">Terminal Velocity & Scatter</div>
                </div>
            </div>

            <button id="btn-start" class="btn-primary">INITIALIZE SESSION</button>
            
            <div class="stats-split-container">
                <!-- Left: Best All Time -->
                <div class="stat-column">
                    <div class="col-header">BEST RECORD</div>
                    <div class="stat-item">
                        <span class="label">REACTION</span>
                        <span class="value mono" style="color: var(--accent)"><span id="best-reaction">--</span> ms</span>
                    </div>
                    <div class="stat-item">
                        <span class="label">RATING</span>
                        <span class="value mono highlight-score" id="best-rating">--</span>
                    </div>
                </div>

                <!-- Right: Last Session -->
                <div class="stat-column">
                    <div class="col-header">LAST SESSION</div>
                    <div class="stat-item">
                        <span class="label">REACTION</span>
                        <span class="value mono" style="color: var(--text-muted)"><span id="last-reaction">--</span> ms</span>
                    </div>
                    <div class="stat-item">
                        <span class="label">RATING</span>
                        <span class="value mono highlight-score" id="last-rating">--</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Gameplay HUD -->
        <section id="game-hud" class="glass-panel hidden">
            <div class="hud-top">
                <div class="stat-box">
                    <span class="label">ROUND</span>
                    <span id="hud-round" class="value mono">1/20</span>
                </div>
                <div class="stat-box">
                    <span class="label">INTENSITY</span>
                    <span id="hud-intensity" class="value mono">1.0</span>
                </div>
                <div class="stat-box">
                    <span class="label">AVG</span>
                    <span id="hud-avg" class="value mono">--</span>
                </div>
            </div>

            <div class="instruction-overlay" id="instruction-text">
                WAIT FOR SIGNAL
            </div>
        </section>

        <!-- Session Summary Modal -->
        <section id="summary-screen" class="glass-panel hidden">
            <h2>SESSION DEBRIEF</h2>
            <div class="summary-grid">
                <div class="stat-card full-width">
                    <span class="label">PERFORMANCE RATING</span>
                    <span id="summary-rating" class="value mono" style="font-size: 1.5rem; margin-top: 0.5rem; color: var(--text);">--</span>
                    <!-- New Verdict Text Element -->
                    <p id="summary-verdict">--</p>
                    <div class="score-bar">
                        <span style="font-size: 0.8rem; letter-spacing: 0.1em; color: var(--text-muted); margin-bottom: 0.2rem;">SCORE</span>
                        <span><span id="summary-score">0</span>/10</span>
                    </div>
                    <div class="score-explanation">
                        Score based on reaction time minus a difficulty handicap (8ms per intensity level).
                    </div>
                </div>
                <div class="stat-card">
                    <span class="label">BEST</span>
                    <span id="summary-best" class="value mono">0</span>
                </div>
                <div class="stat-card">
                    <span class="label">AVERAGE</span>
                    <span id="summary-avg" class="value mono">0</span>
                </div>
                <div class="stat-card full-width" style="flex-direction: row; justify-content: space-between; align-items: center;">
                    <span class="label">FALSE STARTS / TIMEOUTS</span>
                    <span id="summary-errors" class="value mono" style="color: var(--error)">0</span>
                </div>
            </div>
            <button id="btn-restart" class="btn-primary">RESTART PROTOCOL</button>
        </section>

    </div>

    <script src="script.js"></script>
</body>
</html>
